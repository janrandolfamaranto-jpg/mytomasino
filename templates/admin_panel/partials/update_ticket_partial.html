<div id="update-ticket-{{ ticket.pk }}">
  <h5>Ticket: {{ ticket.ticket_id }} - {{ ticket.title }}</h5>
  <p><strong>Category:</strong> {{ ticket.get_category_display }}</p>
  <p><strong>Created By:</strong> {{ ticket.created_by.get_full_name|default:ticket.created_by.username }}</p>
  <p><strong>Current Status:</strong> {{ ticket.get_status_display }}</p>

  <form method="post"
        hx-post="{% url 'admin_panel:update_ticket' ticket.pk %}"
        hx-target="#ticket-detail-{{ ticket.pk }}"
        hx-swap="outerHTML"
        class="mt-3">
    {% csrf_token %}
    <div class="mb-3">
      <label for="status-{{ ticket.pk }}" class="form-label">Select New Status</label>
      <select name="status" id="status-{{ ticket.pk }}" class="form-select" required>
        {% for key, value in ticket.STATUS_CHOICES %}
        <option value="{{ key }}" {% if ticket.status == key %}selected{% endif %}>{{ value }}</option>
        {% endfor %}
      </select>
    </div>

    <button type="submit" class="btn btn-primary">
      <span class="button-text">Update Status</span>
      <span class="htmx-indicator">
        <span class="spinner-border spinner-border-sm ms-1" role="status" aria-hidden="true"></span>
        <span class="ms-1">Updating...</span>
      </span>
    </button>
    <a href="{% url 'admin_panel:ticket_list' %}"
       class="btn btn-secondary"
       hx-get="{% url 'admin_panel:ticket_list' %}"
       hx-target="#ticket-table"
       hx-swap="innerHTML">
      Cancel
    </a>
  </form>
</div>